@page
@using Gitec.Models.InfoDisplay
@model IndexModel
@{
    ViewData["Title"] = "Home page";
}

<div class="container mt-4">
    @if (Model.PublishedInfoBoards?.Any() == true)
    {
        <div id="infoBoardContainer" class="list-group">
            @foreach (var board in Model.PublishedInfoBoards)
            {
                <div class="info-board list-group-item" style="display: none;">
                    <h3>@board.Title</h3>
                    <small class="text-muted">Published on: @board.CreatedAt.ToString("MMM dd, yyyy")</small>

                    <div class="list-group">
                        @foreach (var item in board.InfoBoardItems)
                        {
                            <div class="list-group-item">
                                <h4>@item.Title</h4>
                                <small class="text-muted">@item.Type</small>
                            </div>

                            <div>
                                @switch (item)
                                {
                                    case InfoBoardItemText textItem:
                                        @await Html.PartialAsync("_InfoBoardText", textItem)
                                        break;

                                    case InfoBoardItemMarkdown markdownItem:
                                        @await Html.PartialAsync("_InfoBoardMarkdown", markdownItem)
                                        break;

                                    case InfoBoardItemImage imageItem:
                                        @await Html.PartialAsync("_InfoBoardImage", imageItem)
                                        break;

                                    case InfoBoardItemVideo videoItem:
                                        @await Html.PartialAsync("_InfoBoardVideo", videoItem)
                                        break;

                                    case InfoBoardItemRssFeed rssItem:
                                        @await Html.PartialAsync("_InfoBoardRssFeed", rssItem)
                                        break;

                                    default:
                                        <p class="text-warning">Unknown content type</p>
                                        break;
                                }
                            </div>
                        }
                    </div>
                </div>
            }
        </div>

        <script>
            document.addEventListener("DOMContentLoaded", function () {
                let boards = document.querySelectorAll(".info-board");
                let currentIndex = 0;

                function showNextBoard() {
                    boards.forEach((board, index) => {
                        board.style.display = index === currentIndex ? "block" : "none";
                    });
                    currentIndex = (currentIndex + 1) % boards.length;
                }

                showNextBoard();
                setInterval(showNextBoard, 5000); // Change board every 5 seconds
            });
        </script>
    }
    else
    {
        <p>No published info boards available.</p>
    }
</div>